<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>è«‹å‡ç”³è«‹</title>

<style>
body{
  background:#3f3f3f;
  font-family:system-ui;
}
.card{
  width:320px;
  margin:40px auto;
  background:#f4f4f4;
  padding:16px;
  border-radius:10px;
}
input,select,button,textarea{
  width:100%;
  padding:8px;
  margin:6px 0;
}
button{
  cursor:pointer;
}
.log{
  background:#000;
  color:#0f0;
  font-size:12px;
  height:120px;
  overflow:auto;
  padding:6px;
}
</style>
</head>

<body>

<div class="card">
  <h3>è«‹å‡ç”³è«‹</h3>

  <input id="name" placeholder="å§“å">

  <select id="type">
    <option value="">è«‹é¸æ“‡å‡åˆ¥</option>
    <option>å©šå‡</option>
    <option>å–ªå‡</option>
    <option>è‚²å…’å‡</option>
    <option>ç”Ÿç”¢å‡</option>
    <option>ç—…å‡</option>
    <option>ç‰¹ä¼‘</option>
  </select>

  <label>é–‹å§‹æ—¥æœŸ</label>
  <input type="date" id="start">

  <label>çµæŸæ—¥æœŸ</label>
  <input type="date" id="end">

  <textarea id="reason" placeholder="è«‹å‡åŸå› ï¼ˆé¸å¡«ï¼‰"></textarea>

  <button onclick="submitLeave()">é€å‡ºç”³è«‹</button>

  <div id="log" class="log"></div>
</div>

<script>
const API = "https://punch-api.jackey1688.workers.dev/api/leave";
const logBox = document.getElementById("log");

function log(msg){
  logBox.innerHTML += msg + "<br>";
  logBox.scrollTop = logBox.scrollHeight;
}

async function submitLeave(){

  // âœ… æ­£ç¢ºå– DOMï¼ˆé¿å… ReferenceErrorï¼‰
  const nameEl   = document.getElementById("name");
  const typeEl   = document.getElementById("type");
  const startEl  = document.getElementById("start");
  const endEl    = document.getElementById("end");
  const reasonEl = document.getElementById("reason");

  const name   = nameEl.value.trim();
  const type   = typeEl.value;
  const start  = startEl.value;
  const end    = endEl.value;
  const reason = reasonEl.value.trim();

  if(!name || !type || !start || !end){
    alert("è«‹å¡«å¯«å§“åã€å‡åˆ¥ã€é–‹å§‹èˆ‡çµæŸæ—¥æœŸ");
    return;
  }

  log("ğŸ“¤ é€å‡ºè«‹å‡ç”³è«‹ä¸­â€¦");

  await fetch(API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
      name,
      type,
      start_date: start,
      end_date: end,
      reason
    })
  });

  log("âœ… è«‹å‡ç”³è«‹å·²æˆåŠŸé€å‡º");
}
</script>

</body>
</html>
