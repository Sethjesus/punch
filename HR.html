<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>HR æ‰“å¡å¾Œå°</title>
<style>
table{border-collapse:collapse;width:100%}
td,th{border:1px solid #aaa;padding:4px;text-align:center}
button{cursor:pointer}
</style>
</head>
<body>

<h2>HR æ‰“å¡ç´€éŒ„</h2>

<table>
<thead>
<tr>
  <th>äºº</th><th>å‹•ä½œ</th><th>æ™‚é–“</th><th>è·é›¢</th>
  <th>âœ”</th><th>âœ–</th><th>å‚™è¨»</th><th>åœ°åœ–</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
const API="https://punch-api.jackey1688.workers.dev";

function tw(t){
  return new Date(t).toLocaleString("zh-TW",{timeZone:"Asia/Taipei"});
}

function approve(td){
  td.innerHTML="âœ”";
  td.nextElementSibling.innerHTML="";
}

function reject(td){
  td.innerHTML="âœ–";
  td.previousElementSibling.innerHTML="";
}

function map(lat,lng){
  window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}

async function load(){
  const r=await fetch(API);
  const d=await r.json();
  tbody.innerHTML="";

  d.rows.forEach(x=>{
    tbody.innerHTML+=`
      <tr>
        <td>${x.name}</td>
        <td>${x.action}</td>
        <td>${tw(x.created_at)}</td>
        <td>${x.distance??""}</td>
        <td onclick="approve(this)">âœ”</td>
        <td onclick="reject(this)">âœ–</td>
        <td><input></td>
        <td><button onclick="map(${x.lat},${x.lng})">ğŸ“</button></td>
      </tr>`;
  });
}
load();
</script>

</body>
</html>
